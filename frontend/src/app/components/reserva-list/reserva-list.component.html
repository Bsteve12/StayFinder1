<div class="reserva-list-container">
  <div class="header">
    <h1 class="logo">StayFinder</h1>

    <div class="search-bar">
      <input type="text" placeholder="Buscar reservas..." 
             (input)="onBuscar($event)" 
             [value]="terminoBusqueda" 
             aria-label="Buscar reservas" />
      <button class="btn-buscar" (click)="limpiarFiltros()">Limpiar</button>
    </div>

    @if (reservas.length > 0) {
      <div class="estadisticas">
        <span class="contador">Total: {{ reservas.length }} reservas</span>
        @if (reservasEnCarrito.length > 0) {
          <span class="carrito-contador">ðŸ›’ {{ reservasEnCarrito.length }} en carrito</span>
        }
      </div>
    }
  </div>
  
  @if (loading) {
    <div class="loading">
      <p>Cargando reservas...</p>
      <div class="spinner"></div>
    </div>
  } @else if (error) {
    <div class="error">
      <p>Error al cargar las reservas. Por favor, intÃ©ntalo de nuevo.</p>
      <button (click)="cargarReservas()" class="btn-reintentar">Reintentar</button>
    </div>
  } @else if (reservas.length === 0) {
    <div class="no-productos">
      <p>No hay reservas disponibles.</p>
      <button (click)="cargarReservas()" class="btn-reintentar">Recargar</button>
    </div>
  } @else {
    <div class="filtros">
      @if (reservas.length > 3) {
        <div class="filtro-precio">
          <label>Filtrar por precio:</label>
          <select (change)="filtrarPorPrecio($event)">
            <option value="">Todos</option>
            <option value="bajo">Menos de â‚¬500</option>
            <option value="medio">â‚¬500 - â‚¬1000</option>
            <option value="alto">MÃ¡s de â‚¬1000</option>
          </select>
        </div>
      }
    </div>
    
    @if (reservasFiltradas.length === 0 && reservas.length > 0) {
      <div class="no-resultados">
        <p>No se encontraron reservas con los filtros aplicados.</p>
        <button (click)="limpiarFiltros()" class="btn-limpiar">Limpiar filtros</button>
      </div>
    } @else {
      <div class="reservas-grid">
        @for (reserva of reservasFiltradas; track reserva.id) {
          <app-reserva-card 
            [reserva]="reserva"
            (reservaAgregado)="agregarAlCarrito($event)">
          </app-reserva-card>
        }
      </div>
    }
    
    @if (reservasEnCarrito.length > 0) {
      <div class="resumen-carrito">
        <h3>Resumen del carrito</h3>
        <p>Total: {{ calcularTotal() | currency:'EUR':'symbol':'1.2-2' }}</p>
        <button class="btn-comprar">Proceder al pago</button>
      </div>
    }
  }
</div>
